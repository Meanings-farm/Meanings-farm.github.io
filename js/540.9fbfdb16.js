"use strict";(self["webpackChunkmeanings_farm"]=self["webpackChunkmeanings_farm"]||[]).push([[540],{2610:(e,t,a)=>{a.d(t,{s:()=>u});var l=a(1959),n=a(3673),o=a(8488),i=a.n(o),s=a(6157);const r=e=>(0,l.dq)(e)?e.value:e;function u(e){const t={model:null,params:null,qid:"default",queryWhen:(0,l.Fl)((()=>!0)),local:!1,immediate:!0,onEmpty:null},{model:a,params:o,queryWhen:u,qid:d,local:c,immediate:m,onEmpty:p}=Object.assign({},t,e),h=t=>{const a=r(t);if(a)return a;const l=r(e.fetchParams);if(l)return l;const n=r(e.params);return n||void 0},f=(0,l.qj)({qid:d||"",isPending:!1,haveBeenRequested:!1,haveLoaded:c||!1,error:null,debounceTime:0,latestQuery:null,isLocal:c||!1}),g={items:(0,l.Fl)((()=>{const e=r(o);if(a&&e){if(e.paginate){const t=a.store.state[a.servicePath],{defaultSkip:l,defaultLimit:n}=t.pagination,o=e.query||{},i=o.$skip||l,r=o.$limit||n,u=g.paginationData.value[e.qid||f.qid]||{},d=null!=i&&null!=r?{limit:r,skip:i}:{},c=(0,s.zt)(e,d),m=(0,s.ZC)(u,c,t.keyedById);return console.log("items",m),m}{const t=a.findInStore(e).data;return t}}return[]})),paginationData:(0,l.Fl)((()=>{if(a)return a.store.state[a.servicePath].pagination})),servicePath:(0,l.Fl)((()=>(a||{}).servicePath||""))};function v(e){if(a&&e){const t=r(e);if(t&&u&&u.value&&!f.isLocal)return f.isPending=!0,f.haveBeenRequested=!0,a.find(t).then((e=>{if(f.error=null,f.haveLoaded=!0,!Array.isArray(e)){const a=(0,s.zt)(t,e);a.response=e,a.isOutdated=!1,f.latestQuery=a}return f.isPending=!1,0==e.total&&p&&p(),e}))}}const y={findDebounced(e){return v(e)}};function w(e){const t=h(e);return t&&t.debounce?(t.debounce!==f.debounceTime&&(y.findDebounced=i()(v,t.debounce),f.debounceTime=t.debounce),y.findDebounced(t)):t?v(t):void 0}return(0,n.YP)((()=>h()),(()=>{w()}),{immediate:m}),Object.assign(Object.assign(Object.assign({},g),(0,l.BK)(f)),{find:v})}},6157:(e,t,a)=>{a.d(t,{O1:()=>s,ZC:()=>r,zt:()=>u});var l=a(5822),n=a.n(l),o=a(6766),i=a.n(o);function s(e){let t="";const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let l=0;l<e;l++)t+=a.charAt(Math.floor(Math.random()*a.length));return t}function r(e,t,a){const{queryId:l,pageId:n}=t,o=e[l],i=o&&o[n],s=i&&i.ids;return s&&s.length?s.map((e=>a[e])):[]}function u(e={},t={}){const a=e.query||{},l=e.qid||"default",o=null!==t.limit&&void 0!==t.limit?t.limit:a.$limit,s=null!==t.skip&&void 0!==t.skip?t.skip:a.$skip,r=n()(a,["$limit","$skip"]),u=i()(r),d=void 0!==o?{$limit:o,$skip:s}:void 0,c=d?i()(d):void 0;return{qid:l,query:a,queryId:u,queryParams:r,pageParams:d,pageId:c,response:void 0,isOutdated:void 0}}},2106:(e,t,a)=>{a.d(t,{Z:()=>p});var l=a(3673);function n(e,t,a,n,o,i){const s=(0,l.up)("q-btn");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(s,{flat:"",icon:"navigate_before",disabled:!n.havePrev,onClick:t[0]||(t[0]=e=>n.goTo("/sumerian/line/",(n.prev||{}).id))},null,8,["disabled"]),(0,l.Wm)(s,{flat:"",icon:"reorder",disabled:!n.haveCorpusId,onClick:t[1]||(t[1]=e=>n.goTo("/text/",a.corpusId))},null,8,["disabled"]),(0,l.Wm)(s,{flat:"",icon:"navigate_next",disabled:!n.haveNext,onClick:t[2]||(t[2]=e=>n.goTo("/sumerian/line/",(n.next||{}).id))},null,8,["disabled"])])}var o=a(1959),i=a(2610);const s={name:"Pagination",props:{corpusId:{type:String,required:!1},currentId:{type:String,required:!1}},setup(e,t){const{List:a}=t.root.$FeathersVuex.api,{$router:l}=t.root,n=(0,o.Fl)((()=>e.corpusId)),s=(0,o.Fl)((()=>void 0!==u.value)),{items:r}=(0,i.s)({model:a,params:(0,o.Fl)((()=>({query:{id:n.value,$sort:{createdAt:1},$limit:1}}))),queryWhen:(0,o.Fl)((()=>n.value))}),u=(0,o.Fl)((()=>e.currentId)),d=(0,o.Fl)((()=>{const e=u.value;if(e){let t;const a=(r.value||[])[0];if(a&&a.items){const l=a.items;for(const a in l){const n=l[a];if(n.id===e)return t;t=n}}}})),c=(0,o.Fl)((()=>void 0!==d.value)),m=(0,o.Fl)((()=>{const e=u.value;if(e){let t=!1;const a=(r.value||[])[0];if(a&&a.items){const l=a.items;for(const a in l){const n=l[a];if(t)return n;n.id===e&&(t=!0)}}}})),p=(0,o.Fl)((()=>void 0!==m.value)),h=(e,t)=>{l.push({path:e+t})};return{haveCorpusId:s,havePrev:c,prev:d,haveNext:p,next:m,goTo:h}}};var r=a(4260),u=a(4607),d=a(7518),c=a.n(d);const m=(0,r.Z)(s,[["render",n]]),p=m;c()(s,"components",{QBtn:u.Z})},6540:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ke});var l=a(3673),n=a(2323),o=a(8880);const i={class:"row justify-center"},s={class:"row"},r={class:"col-7"},u={class:"row full-width bg-grey-4"},d={class:"row full-width q-py-sm"},c={class:"row full-width q-pb-sm"},m={class:"fit text-h5",filled:""},p={class:"row full-width bg-grey-4"},h=["onMouseover"],f={class:"row"},g={class:"col-1"},v=["v-slot:option"],y=["onClick"],w=["innerHTML"],b={class:"col-1 text-body1"},k={class:"col-1 text-body1"},q={key:0},V={class:"col-auto text-body1"},_={class:"text-body1"},I={class:"q-gutter-sm"},W={key:0,class:"row"},x=(0,l._)("div",{class:"col-5"},null,-1),C={class:"col-7 text-body1"},F=["onClick"],U={class:"text-body1"},z={class:"col text-body1"},D=(0,l.Uk)("•"),P={class:"col-5"},T={class:"col-3 text-body1"},Q=["onClick"],$={key:0},S={key:1},Z={class:"col text-body1"},j=["onClick"],E={key:0};function O(e,t,a,O,A,B){const L=(0,l.up)("q-btn"),H=(0,l.up)("q-space"),M=(0,l.up)("Pagination"),Y=(0,l.up)("q-btn-toggle"),K=(0,l.up)("q-input"),N=(0,l.up)("q-popup-edit"),R=(0,l.up)("q-icon"),G=(0,l.up)("q-separator"),J=(0,l.up)("q-badge"),X=(0,l.up)("q-item-section"),ee=(0,l.up)("q-item"),te=(0,l.up)("q-list"),ae=(0,l.up)("q-menu"),le=(0,l.up)("FeathersVuexFindOrDefault"),ne=(0,l.up)("q-radio"),oe=(0,l.up)("FeathersVuexFormWrapper"),ie=(0,l.up)("q-scroll-area"),se=(0,l.up)("q-tab"),re=(0,l.up)("q-tabs"),ue=(0,l.up)("q-tab-panel"),de=(0,l.up)("q-tab-panels"),ce=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(ce,{class:"q-pa-md"},{default:(0,l.w5)((()=>[(0,l._)("div",i,[(0,l.Wm)(L,{flat:"",round:"",icon:"edit",color:O.state.editable?"primary":"secondary",onClick:t[0]||(t[0]=e=>O.state.editable=!O.state.editable)},null,8,["color"]),(0,l.Wm)(H),(0,l.Wm)(M,{corpusId:O.state.corpusId,currentId:O.state.lineId},null,8,["corpusId","currentId"]),(0,l.Wm)(H),(0,l.Wm)(Y,{modelValue:O.state.language3,"onUpdate:modelValue":t[1]||(t[1]=e=>O.state.language3=e),"no-caps":"",rounded:"",unelevated:"","toggle-color":"primary",color:"white","text-color":"primary",options:[{label:"rus",value:"rus"},{label:"eng",value:"eng"}],onInput:t[2]||(t[2]=e=>B.switchLang(e))},null,8,["modelValue"])]),(0,l._)("div",s,[(0,l._)("div",r,[(0,l._)("div",u,[(0,l._)("small",null,(0,n.zw)(e.$t("translation")),1),(0,l._)("div",{class:"fit text-body1",ref:"target"},(0,n.zw)(O.tv.text||""),513),(0,l.Wm)(N,{modelValue:O.tv.text,"onUpdate:modelValue":t[4]||(t[4]=e=>O.tv.text=e),onSave:t[5]||(t[5]=(e,t)=>O.updateTv(e,t))},{default:(0,l.w5)((({set:e,cancel:a})=>[(0,l.Wm)(K,{color:"accent",dense:"",autofocus:"",modelValue:O.tv.text,"onUpdate:modelValue":t[3]||(t[3]=e=>O.tv.text=e)},{after:(0,l.w5)((()=>[(0,l.Wm)(L,{flat:"",dense:"",color:"positive",icon:"check_circle",onClick:(0,o.iM)(e,["stop"])},null,8,["onClick"]),(0,l.Wm)(L,{flat:"",dense:"",color:"negative",icon:"cancel",onClick:(0,o.iM)(a,["stop"])},null,8,["onClick"])])),_:2},1032,["modelValue"])])),_:1},8,["modelValue"])]),(0,l._)("div",d,(0,n.zw)(e.$t("line"))+"# "+(0,n.zw)(O.state.lineNumber),1),(0,l._)("div",c,[(0,l._)("small",null,(0,n.zw)(e.$t("cuneiform")),1),(0,l._)("div",m,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Array.from(O.state.original||""),((e,t)=>((0,l.wg)(),(0,l.iD)("span",{key:t,class:(0,n.C_)({selected:O.isCuneiformHighlighted(t)})},(0,n.zw)(e),3)))),128))]),(0,l.Wm)(N,{modelValue:O.state.cuneiform,"onUpdate:modelValue":t[7]||(t[7]=e=>O.state.cuneiform=e),onSave:t[8]||(t[8]=(e,t)=>O.updateCuneiform(e,t))},{default:(0,l.w5)((({set:e,cancel:a})=>[(0,l.Wm)(K,{color:"accent text-h5",dense:"",autofocus:"",modelValue:O.state.cuneiform||O.state.original||"","onUpdate:modelValue":t[6]||(t[6]=e=>O.state.cuneiform=e)},{append:(0,l.w5)((()=>[(0,l.Wm)(R,{name:"edit",onClick:e},null,8,["onClick"]),(0,l.Wm)(L,{flat:"",dense:"",color:"negative",icon:"cancel",onClick:(0,o.iM)(a,["stop"])},null,8,["onClick"]),(0,l.Wm)(L,{flat:"",dense:"",color:"",icon:"local_fire_department",onClick:e=>{O.resetTransliteration(),a()}},null,8,["onClick"])])),_:2},1032,["modelValue"])])),_:1},8,["modelValue"])]),(0,l.Wm)(G),(0,l._)("div",p,[(0,l._)("small",null,(0,n.zw)(e.$t("transliteration")),1),(0,l._)("div",{class:"fit text-body1",ref:"target"},(0,n.zw)(O.transliteration),513),(0,l.Wm)(N,{onSave:t[10]||(t[10]=(e,t)=>O.updateTransliteration(e,t)),onBeforeShow:t[11]||(t[11]=e=>O.state.transliteration=(O.state.translation||{}).transliteration||""),modelValue:(O.state.translation||{}).transliteration||"","onUpdate:modelValue":t[12]||(t[12]=e=>O.state.transliteration=e)},{default:(0,l.w5)((({set:e,cancel:a})=>[(0,l.Wm)(K,{color:"accent",modelValue:O.state.transliteration,"onUpdate:modelValue":t[9]||(t[9]=e=>O.state.transliteration=e),dense:"",autofocus:""},{after:(0,l.w5)((()=>[(0,l.Wm)(L,{flat:"",dense:"",color:"positive",icon:"check_circle",onClick:(0,o.iM)(e,["stop"])},null,8,["onClick"]),(0,l.Wm)(L,{flat:"",dense:"",color:"negative",icon:"cancel",onClick:(0,o.iM)(a,["stop"])},null,8,["onClick"]),(0,l.Wm)(L,{flat:"",dense:"",color:"",icon:"local_fire_department",onClick:e=>{O.resetTransliteration(),a()}},null,8,["onClick"])])),_:2},1032,["modelValue"])])),_:1},8,["modelValue"])]),(0,l.Wm)(G),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(O.translation.details||[],((a,i)=>((0,l.wg)(),(0,l.iD)("span",{key:i,onMouseover:e=>O.state.over=a,onMouseleave:t[13]||(t[13]=e=>O.state.over="")},[(0,l._)("div",f,[(0,l._)("div",g,[O.state.editable?((0,l.wg)(),(0,l.j4)(le,{key:0,service:"variations",query:{symbols:a.cuneiform.text,language:"sumerian"},fetchQuery:{symbols:a.cuneiform.text,language:"sumerian"},watch:["query.symbols"]},{default:(0,l.w5)((({items:t})=>[(0,l._)("template",{"v-slot:option":(t||[])[0]||{}},[(0,l.Wm)(L,{flat:"",label:""},{default:(0,l.w5)((()=>[(0,l.Wm)(J,{color:"orange",outline:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)((e.option.splits||[]).length),1)])),_:1}),(0,l.Wm)(ae,{"auto-close":""},{default:(0,l.w5)((()=>[(0,l.Wm)(te,{style:{"min-width":"100px"}},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.option.splits,((t,o)=>((0,l.wg)(),(0,l.j4)(ee,{clickable:"",key:o,onClick:l=>O.splitBy(t,a,e.option.transliterations)},{default:(0,l.w5)((()=>[(0,l.Wm)(X,null,{default:(0,l.w5)((()=>[(0,l._)("span",null,(0,n.zw)(B.arrayToVisual(t)),1),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t,((t,a)=>((0,l.wg)(),(0,l.iD)("span",{key:a},(0,n.zw)(B.label((((e.option.meanings[t]||{}).trans||{})[0]||{}).labels)),1)))),128))])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:2},1024)])),_:2},1024)])),_:2},1024)],8,v)])),_:2},1032,["query","fetchQuery","watch"])):(0,l.kq)("",!0)]),(0,l._)("div",{class:(0,n.C_)(["col-2 text-body1 cursor-pointer",{warning:B.checkForError(a)}]),onClick:e=>O.state.position={data:a,pos:i,type:"root"}},[(0,l._)("span",{class:(0,n.C_)(["text-body1",{selected:O.state.position.data===a}]),innerHTML:B.formatLemma(a)},null,10,w)],10,y),(0,l._)("div",b,[(0,l.Uk)((0,n.zw)(a.data.allPc),1),(0,l._)("sub",null,(0,n.zw)(a.data.allPcTotal),1)]),(0,l._)("div",k,[a.pos?((0,l.wg)(),(0,l.iD)("span",q,[(0,l.Uk)((0,n.zw)(a.pos)+" ",1),(0,l._)("small",null,(0,n.zw)(a.data.pc),1)])):(0,l.kq)("",!0)]),(0,l._)("div",V,[(0,l._)("span",_,(0,n.zw)(B.label(a.data.sense,a.label)),1),O.translation?((0,l.wg)(),(0,l.j4)(oe,{key:0,item:O.translation,watch:""},{default:(0,l.w5)((({clone:e,save:t})=>[(0,l.Wm)(N,{modelValue:e.details[i].label,"onUpdate:modelValue":t=>e.details[i].label=t,onBeforeShow:t=>B.checkLabel(e.details[i]),onSave:(e,a)=>t()},{default:(0,l.w5)((({initialValue:t,value:a,validate:n,set:s,cancel:r})=>[(0,l.Wm)(K,{color:"accent",modelValue:e.details[i].label,"onUpdate:modelValue":t=>e.details[i].label=t,dense:"",autofocus:"",counter:""},{before:(0,l.w5)((()=>[(0,l.Wm)(L,{flat:"",dense:"",color:"negative",icon:"cancel",onClick:(0,o.iM)(r,["stop"])},null,8,["onClick"]),(0,l.Wm)(L,{flat:"",dense:"",color:"positive",icon:"check_circle",onClick:(0,o.iM)(s,["stop"]),disable:!1===n(a)||t===a},null,8,["onClick","disable"])])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,l._)("div",I,[(0,l.Wm)(ne,{modelValue:e.details[i].pos,"onUpdate:modelValue":t=>e.details[i].pos=t,val:"N",label:"N"},null,8,["modelValue","onUpdate:modelValue"]),(0,l.Wm)(ne,{modelValue:e.details[i].pos,"onUpdate:modelValue":t=>e.details[i].pos=t,val:"GN",label:"GN"},null,8,["modelValue","onUpdate:modelValue"]),(0,l.Wm)(ne,{modelValue:e.details[i].pos,"onUpdate:modelValue":t=>e.details[i].pos=t,val:"AJ",label:"AJ"},null,8,["modelValue","onUpdate:modelValue"]),(0,l.Wm)(ne,{modelValue:e.details[i].pos,"onUpdate:modelValue":t=>e.details[i].pos=t,val:"V/t",label:"V/t"},null,8,["modelValue","onUpdate:modelValue"]),(0,l.Wm)(ne,{modelValue:e.details[i].pos,"onUpdate:modelValue":t=>e.details[i].pos=t,val:"V/i",label:"V/i"},null,8,["modelValue","onUpdate:modelValue"]),(0,l.Wm)(ne,{modelValue:e.details[i].pos,"onUpdate:modelValue":t=>e.details[i].pos=t,val:"IP",label:"IP"},null,8,["modelValue","onUpdate:modelValue"]),(0,l.Wm)(ne,{modelValue:e.details[i].pos,"onUpdate:modelValue":t=>e.details[i].pos=t,val:"QP",label:"QP"},null,8,["modelValue","onUpdate:modelValue"]),(0,l.Wm)(ne,{modelValue:e.details[i].pos,"onUpdate:modelValue":t=>e.details[i].pos=t,val:"",label:"n/a"},null,8,["modelValue","onUpdate:modelValue"])])])),_:2},1032,["modelValue","onUpdate:modelValue","onBeforeShow","onSave"])])),_:2},1032,["item"])):(0,l.kq)("",!0)])]),(0,l.Wm)(le,{service:"morphology",query:{word:a.text,lemma:a.lemma,pos:a.pos,language:"sumerian"},fetchQuery:{word:a.text,lemma:a.lemma,pos:a.pos,language:"sumerian"},watch:["query.word","query.lemma","query.pos"]},{default:(0,l.w5)((({items:e})=>[(e||[]).length>0?((0,l.wg)(),(0,l.iD)("div",W,[x,(0,l._)("div",C,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e||[],((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"row",key:t},[(0,l._)("div",{class:"col-3 cursor-pointer",onClick:a=>O.state.position={data:e,pos:t,type:"*fix"}},[(0,l._)("span",U,(0,n.zw)(e.text),1)],8,F),(0,l._)("div",z,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.meanings||[],((t,a)=>((0,l.wg)(),(0,l.iD)("div",{class:"row",key:a},[e.meanings.length>1?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[D],64)):(0,l.kq)("",!0),(0,l.Uk)(" "+(0,n.zw)(O.phLabel(t).value),1)])))),128))])])))),128))])])):(0,l.kq)("",!0)])),_:2},1032,["query","fetchQuery","watch"]),(0,l.Wm)(G)],40,h)))),128))]),(0,l._)("div",P,[(0,l.Wm)(ie,{style:{height:"110px","max-width":"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(te,{dense:"",style:{"min-width":"100px"}},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((O.roots[0]||{}).roots,((t,a)=>((0,l.wg)(),(0,l.j4)(ee,{clickable:"",key:a,onClick:a=>e.selectRoot(t)},{default:(0,l.w5)((()=>[(0,l.Wm)(X,{class:"text-body1"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(t.symbols)+" - "+(0,n.zw)(B.label(((((t||{}).meaning||{}).trans||[])[0]||{}).labels)),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1}),(0,l.Wm)(re,{modelValue:O.state.tab,"onUpdate:modelValue":t[14]||(t[14]=e=>O.state.tab=e),dense:"",class:"text-grey bg-grey-3","active-color":"primary","indicator-color":"primary",align:"justify"},{default:(0,l.w5)((()=>[(0,l.Wm)(se,{name:"visual",label:e.$t("vocablary")},{default:(0,l.w5)((()=>[(0,l.Wm)(J,{color:"red",floating:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(O.visualVariants.length),1)])),_:1})])),_:1},8,["label"])])),_:1},8,["modelValue"]),(0,l.Wm)(de,{modelValue:O.state.tab,"onUpdate:modelValue":t[15]||(t[15]=e=>O.state.tab=e),animated:"",swipeable:"",vertical:"","transition-prev":"jump-right","transition-next":"jump-left"},{default:(0,l.w5)((()=>[(0,l.Wm)(ue,{name:"visual"},{default:(0,l.w5)((()=>[(0,l.Wm)(ie,{style:{height:"500px","max-width":"100%"}},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(O.visualVariants,((t,a)=>((0,l.wg)(),(0,l.iD)("div",{class:"row",key:a},[(0,l._)("div",T,[(0,l.Wm)(G),(0,l.Uk)(" "+(0,n.zw)(t.lemma)+" "+(0,n.zw)(t.pos),1),(0,l._)("div",null,[(0,l._)("a",{class:"cursor-pointer",onClick:a=>e.openSearch(t.visual)},(0,n.zw)(t.visual),9,Q),(0,l.Uk)(" "+(0,n.zw)(t.normaliazed),1)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.dates||[],((e,t)=>((0,l.wg)(),(0,l.iD)("small",{class:"row",key:t},["UrIII"===e.k||"OB"===e.k?((0,l.wg)(),(0,l.iD)("b",$,(0,n.zw)(e.k)+" "+(0,n.zw)(e.v),1)):((0,l.wg)(),(0,l.iD)("span",S,(0,n.zw)(e.k)+" "+(0,n.zw)(e.v),1))])))),128))]),(0,l._)("div",Z,[(0,l.Wm)(G),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.trans,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{class:"row cursor-pointer",key:a,onClick:a=>O.selectTranslation(t,e)},[(0,l.Uk)((0,n.zw)(B.label(e.labels))+" ",1),e.count?((0,l.wg)(),(0,l.iD)("span",E,"   "+(0,n.zw)(e.count)+" / "+(0,n.zw)(B.pcToString(e.pc))+"%",1)):(0,l.kq)("",!0)],8,j)))),128))])])))),128))])),_:1})])),_:1})])),_:1},8,["modelValue"])])])])),_:1})}a(7098),a(7280),a(6801),a(107);var A=a(1959),B=a(2106),L=a(2610),H=(a(5363),a(6157)),M=a(5495),Y=a.n(M);const K={props:{service:{type:String,required:!0},query:{type:Object,default:null},queryWhen:{type:[Boolean,Function],default:!0},onEmpty:{type:Function,default:null},fetchQuery:{type:Object},params:{type:Object,default:null},fetchParams:{type:Object,default:null},watch:{type:[String,Array],default(){return[]}},local:{type:Boolean,default:!1},editScope:{type:Function,default(e){return e}},qid:{type:String,default(){return(0,H.O1)(10)}},temps:{type:Boolean,default:!1}},data:()=>({isFindPending:!1,queryId:null,pageId:null,items:[]}),computed:{pagination(){return this.$store.state[this.service].pagination[this.qid]},queryInfo(){return null==this.pagination||null==this.queryId?{}:Y()(this.pagination,this.queryId,{})},pageInfo(){return null==this.pagination||null==this.queryId||null==this.pageId?{}:Y()(this.pagination,[this.queryId,this.pageId],{})},scope(){const{items:e,isFindPending:t,pagination:a,queryInfo:l,pageInfo:n}=this,o={isFindPending:t,pagination:a,items:e,queryInfo:l,pageInfo:n};return this.editScope(o)||o}},methods:{findData(){const e=this.fetchQuery||this.query;let t=this.fetchParams||this.params;if(("function"===typeof this.queryWhen?this.queryWhen(this.params||this.query):this.queryWhen)&&(this.isFindPending=!0,t||e))return t=t?Object.assign({},t,{qid:this.qid||"default"}):{query:e,qid:this.qid||"default"},this.$store.dispatch(`${this.service}/find`,t).then((e=>{this.isFindPending=!1;const{queryId:a,pageId:l}=(0,H.zt)(t,e);this.queryId=a,this.pageId=l,this.items=e.data,0===e.total&&this.onEmpty&&this.onEmpty()}))},fetchData(){if(!this.local){if(this.params||this.query)return this.findData();console.log("No query and no id provided, so no data will be fetched.")}}},setup(){if(!this.$FeathersVuex)throw new Error("You must first Vue.use the FeathersVuex plugin before using the 'FeathersVuexFind' component.");if(!this.$store.state[this.service])throw new Error(`The '${this.service}' plugin not registered with feathers-vuex`);const e=Array.isArray(this.watch)?this.watch:[this.watch];(this.fetchQuery||this.query||this.params)&&(e.forEach((e=>{if("string"!==typeof e)throw new Error("Values in the 'watch' array must be strings.");this.fetchQuery&&e.startsWith("query")&&(e=e.replace("query","fetchQuery")),this.fetchParams&&e.startsWith("params")&&(e=e.replace("params","fetchParams")),this.$watch(e,this.fetchData)})),this.fetchData())},render(){return this.$scopedSlots.default(this.scope)}},N=(e,t)=>{if(e)for(const a in e){const l=e[a];if(t===l.visual){const e=l.dates,t=[];for(const a in e){const l=e[a];t.push({k:a,v:parseInt(l)})}return t.sort(((e,t)=>{const a=e.v,l=t.v;return a>l?-1:a>l?1:0})),t}}return[]},R={name:"PageSentence",components:{Pagination:B.Z,FeathersVuexFindOrDefault:K},props:{id:{type:String,required:!0}},watch:{id(e,t){this.state.lineId=e,this.loadData()}},setup(e,t){const{Atom:a,Visual:n,Translation:o,Tv:i,Roots:s}=t.root.$FeathersVuex.api,r=(0,A.qj)({editable:!0,language2:"ru",language3:"rus",tab:"visual",corpusId:"",lineId:e.id,split:[],position:{data:{},pos:-1},lineNumber:"",original:"",transliteration:"",doReset:!0,cuneiform:"",over:"",highlightCuneiform:(0,A.Fl)((()=>{if(r.over){const e=(r.translation||{}).details||[];let t=0;for(const a in e){const l=e[a];if(r.over===l)return[t,t+Array.from((l.cuneiform||{}).text||"").length-1];t+=Array.from((l.cuneiform||{}).text||"").length}}return[-1,-1]}))}),u=e=>{const t=r.highlightCuneiform||[-1,-1];return e>=t[0]&&e<=t[1]},d=()=>{r.corpusId="",r.split=[],r.position={data:{},pos:-1},r.lineNumber="",r.original="",r.transliteration="",r.doReset=!0},c=e=>{d(),r.split=e},m=()=>{const e=r.lineId;e&&a.find({query:{class:"line",id:e,$sort:{createdAt:1},$limit:25}}).then((e=>{const t=((e||{}).data||[])[0]||{};r.corpusId=t.corpusId||"",r.lineNumber=t.number||"?",r.original=t.original||""}))};m();const{items:p}=(0,L.s)({model:o,params:(0,A.Fl)((()=>({query:{version:"draft",lineId:r.lineId,language:"sumerian"}}))),queryWhen:(0,A.Fl)((()=>r.lineId)),onEmpty:()=>{if(r.lineId){const e=new o({version:"draft",lineId:r.lineId,language:"sumerian",update:"reset"});e.create()}}}),h=(0,A.Fl)((()=>{const e=p.value[0];return e||{}}));(0,l.YP)(h,((e,t)=>{r.translation=e||{}}));const{items:f}=(0,L.s)({model:i,params:(0,A.Fl)((()=>({query:{version:"draft",lineId:r.lineId,language:"sumerian"}}))),queryWhen:(0,A.Fl)((()=>r.lineId)),onEmpty:()=>{if(r.lineId){const e=new i({version:"draft",lineId:r.lineId,language:"sumerian",text:""});e.create()}}}),g=(0,A.Fl)((()=>{const e=f.value[0]||{};return e&&e.clone?e.clone():e})),v=(0,A.Fl)((()=>{const e=h.value,t=e.transliteration||"";return t})),y=(0,A.Fl)((()=>{const e=r.position||{};return"root"===e.type?((e.data||{}).cuneiform||{}).text:""})),w=(0,A.Fl)((()=>{const e=r.position||{};return"root"===e.type?((e.data||{}).cuneiform||{}).lemma:""})),{items:b}=(0,L.s)({model:s,params:(0,A.Fl)((()=>({query:{symbols:y.value,language:"sumerian"}}))),queryWhen:(0,A.Fl)((()=>y.value))}),{items:k}=(0,L.s)({model:n,params:(0,A.Fl)((()=>({query:{visual:w.value,$limit:50},paginate:!1}))),queryWhen:w}),q=(0,A.Fl)((()=>{const e=k.value;if(e){const t=[];return e.forEach((e=>{const a=e.visual,l=e.normaliazed;e.meanings&&e.meanings.forEach((e=>{let n=0,o=0;(e.trans||[]).forEach((e=>{o+=e.count||0}));const i=N(e.cuneiforms,a);i.forEach((e=>{"UrIII"!==e.k&&"OB"!==e.k||(n+=parseInt(e.v))}));const s={ref:e._id,lemma:e.lemma,pos:e.pos,trans:e.trans,visual:a,normaliazed:l,dates:i,count:n,total:o};t.push(s)}))})),t.sort(((e,t)=>{const a=e.count||0,l=t.count||0,n=e.total||0,o=t.total||0;return a>l?-1:a<l?1:n>o?-1:n<o?1:0})),t}return[]})),V=(e,t)=>{const a=h.value;if(e&&e.ref&&t&&a){const l=a.clone(),n=l.details,o=n[r.position.pos];o&&(t.ref?(o.label="",o.pos=e.pos,o.meaningId=e.ref,o.senseId=t.ref,l.update="nothing",l.save()):t.label&&(o.label=t.label,o.pos=e.pos,o.meaningId=e.ref,o.senseId="",l.update="nothing",l.save()))}},_=(e,t)=>{const a=e||"";if(a!==t){const e=g.value;e.text=a,e.save()}},I=(e,t)=>{console.log("updateCuneiform",e,t);const a=e||"";if(a!==t&&a){const e=h.value.clone();e.update={cuneiform:a},e.save(),d()}r.cuneiform=""},W=(e,t)=>{const a=e||"";if(a!==t){const e=h.value.clone();e.update={transliteration:a},e.save(),r.doReset=a,d()}},x=()=>{const e=h.value.clone();e.update="reset",e.save(),r.doReset=!0,d()},C=(e,t,a)=>{const l=e.map((e=>a[e]||"?")).reduce(((e,t)=>e+" "+(t||"")),"").trim(),n=((h.value||{}).details||[]).map((e=>e===t?l:e.text)).reduce(((e,t)=>e+" "+(t||"")),"").trim();W(n,r.transliteration)},F=e=>(0,A.Fl)((()=>"object"===typeof e&&null!==e?e[r.language2]:e));return{state:r,loadData:m,resetSelections:d,selectSplit:c,roots:b,visualText:y,visuals:k,visualVariants:q,transliteration:v,translation:h,selectTranslation:V,updateTransliteration:W,resetTransliteration:x,isCuneiformHighlighted:u,updateCuneiform:I,tv:g,updateTv:_,splitBy:C,phLabel:F}},methods:{arrayToVisual(e){const t=[];return e.forEach((e=>{t.push(e)})),t.join(" • ")},toVisual(e){const t=[];return e.forEach((e=>{t.push(e.visual)})),t.join(" • ")},toText(e){const t=[];return e.forEach((e=>{t.push(e.text)})),t.join(" ")},toTrans(e){const t=[];return e.forEach((e=>{t.push(e.trans)})),t.join(" ")},checkForError(e){const t=(e.text||"").indexOf(e.lemma);return-1===t},label(e,t){return t||(e&&(e[this.state.language3]||e.label)||"")},pcToString(e){const t=100*(e||0);return t.toString().substring(0,4)},checkLabel(e){e.label||(e.label=((e.data||{}).sense||{})[this.state.language3]||"")},formatLemma(e){const t=e.lemma;let a=e.text||e.data.text;a=a.replaceAll("<","_").replaceAll(">","_").replaceAll("/>","_");const l=a.indexOf(t);return-1===l?a+="<small> ["+e.lemma+"] </small>":a=a.substring(0,l)+"<b>"+t+"</b>"+a.substring(l+t.length),a},switchLang(e){let t=e;switch(t){case"rus":t="ru";break;case"eng":t="en";break}this.$i18n.locale=t,this.state.language2=t}},mounted(){const e=(navigator.language||navigator.userLanguage||"en").split("-")[0];switch(this.$i18n.locale=e,this.$i18n.locale){case"ru":this.state.language2="ru",this.state.language3="rus";break;case"en":this.state.language2="en",this.state.language3="eng";break}}};var G=a(4260),J=a(4379),X=a(4607),ee=a(2025),te=a(8761),ae=a(1289),le=a(7163),ne=a(4554),oe=a(5869),ie=a(9068),se=a(9721),re=a(6335),ue=a(7011),de=a(3414),ce=a(2035),me=a(7991),pe=a(7704),he=a(7547),fe=a(3269),ge=a(5906),ve=a(6602),ye=a(7518),we=a.n(ye);const be=(0,G.Z)(R,[["render",O]]),ke=be;we()(R,"components",{QPage:J.Z,QBtn:X.Z,QSpace:ee.Z,QBtnToggle:te.Z,QPopupEdit:ae.Z,QInput:le.Z,QIcon:ne.Z,QSeparator:oe.Z,QTable:ie.Z,QBadge:se.Z,QMenu:re.Z,QList:ue.Z,QItem:de.Z,QItemSection:ce.Z,QRadio:me.Z,QScrollArea:pe.Z,QTabs:he.Z,QTab:fe.Z,QTabPanels:ge.Z,QTabPanel:ve.Z})}}]);