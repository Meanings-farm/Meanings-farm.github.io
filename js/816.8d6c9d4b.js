"use strict";(self["webpackChunkmeanings_farm"]=self["webpackChunkmeanings_farm"]||[]).push([[816],{2610:(e,t,a)=>{a.d(t,{s:()=>u});var n=a(1959),i=a(3673),l=a(8488),o=a.n(l),s=a(6157);const r=e=>(0,n.dq)(e)?e.value:e;function u(e){const t={model:null,params:null,qid:"default",queryWhen:(0,n.Fl)((()=>!0)),local:!1,immediate:!0,onEmpty:null},{model:a,params:l,queryWhen:u,qid:d,local:c,immediate:p,onEmpty:m}=Object.assign({},t,e),v=t=>{const a=r(t);if(a)return a;const n=r(e.fetchParams);if(n)return n;const i=r(e.params);return i||void 0},g=(0,n.qj)({qid:d||"",isPending:!1,haveBeenRequested:!1,haveLoaded:c||!1,error:null,debounceTime:0,latestQuery:null,isLocal:c||!1}),b={items:(0,n.Fl)((()=>{const e=r(l);if(a&&e){if(e.paginate){const t=a.store.state[a.servicePath],{defaultSkip:n,defaultLimit:i}=t.pagination,l=e.query||{},o=l.$skip||n,r=l.$limit||i,u=b.paginationData.value[e.qid||g.qid]||{},d=null!=o&&null!=r?{limit:r,skip:o}:{},c=(0,s.zt)(e,d),p=(0,s.ZC)(u,c,t.keyedById);return console.log("items",p),p}{const t=a.findInStore(e).data;return t}}return[]})),paginationData:(0,n.Fl)((()=>{if(a)return a.store.state[a.servicePath].pagination})),servicePath:(0,n.Fl)((()=>(a||{}).servicePath||""))};function f(e){if(a&&e){const t=r(e);if(t&&u&&u.value&&!g.isLocal)return g.isPending=!0,g.haveBeenRequested=!0,a.find(t).then((e=>{if(g.error=null,g.haveLoaded=!0,!Array.isArray(e)){const a=(0,s.zt)(t,e);a.response=e,a.isOutdated=!1,g.latestQuery=a}return g.isPending=!1,0==e.total&&m&&m(),e}))}}const w={findDebounced(e){return f(e)}};function y(e){const t=v(e);return t&&t.debounce?(t.debounce!==g.debounceTime&&(w.findDebounced=o()(f,t.debounce),g.debounceTime=t.debounce),w.findDebounced(t)):t?f(t):void 0}return(0,i.YP)((()=>v()),(()=>{y()}),{immediate:p}),Object.assign(Object.assign(Object.assign({},b),(0,n.BK)(g)),{find:f})}},6157:(e,t,a)=>{a.d(t,{O1:()=>s,ZC:()=>r,zt:()=>u});var n=a(5822),i=a.n(n),l=a(6766),o=a.n(l);function s(e){let t="";const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*a.length));return t}function r(e,t,a){const{queryId:n,pageId:i}=t,l=e[n],o=l&&l[i],s=o&&o.ids;return s&&s.length?s.map((e=>a[e])):[]}function u(e={},t={}){const a=e.query||{},n=e.qid||"default",l=null!==t.limit&&void 0!==t.limit?t.limit:a.$limit,s=null!==t.skip&&void 0!==t.skip?t.skip:a.$skip,r=i()(a,["$limit","$skip"]),u=o()(r),d=void 0!==l?{$limit:l,$skip:s}:void 0,c=d?o()(d):void 0;return{qid:n,query:a,queryId:u,queryParams:r,pageParams:d,pageId:c,response:void 0,isOutdated:void 0}}},2106:(e,t,a)=>{a.d(t,{Z:()=>m});var n=a(3673);function i(e,t,a,i,l,o){const s=(0,n.up)("q-btn");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(s,{flat:"",icon:"navigate_before",disabled:!i.havePrev,onClick:t[0]||(t[0]=e=>i.goTo("/sumerian/line/",(i.prev||{}).id))},null,8,["disabled"]),(0,n.Wm)(s,{flat:"",icon:"reorder",disabled:!i.haveCorpusId,onClick:t[1]||(t[1]=e=>i.goTo("/text/",a.corpusId))},null,8,["disabled"]),(0,n.Wm)(s,{flat:"",icon:"navigate_next",disabled:!i.haveNext,onClick:t[2]||(t[2]=e=>i.goTo("/sumerian/line/",(i.next||{}).id))},null,8,["disabled"])])}var l=a(1959),o=a(2610);const s={name:"Pagination",props:{corpusId:{type:String,required:!1},currentId:{type:String,required:!1}},setup(e,t){const{List:a}=t.root.$FeathersVuex.api,{$router:n}=t.root,i=(0,l.Fl)((()=>e.corpusId)),s=(0,l.Fl)((()=>void 0!==u.value)),{items:r}=(0,o.s)({model:a,params:(0,l.Fl)((()=>({query:{id:i.value,$sort:{createdAt:1},$limit:1}}))),queryWhen:(0,l.Fl)((()=>i.value))}),u=(0,l.Fl)((()=>e.currentId)),d=(0,l.Fl)((()=>{const e=u.value;if(e){let t;const a=(r.value||[])[0];if(a&&a.items){const n=a.items;for(const a in n){const i=n[a];if(i.id===e)return t;t=i}}}})),c=(0,l.Fl)((()=>void 0!==d.value)),p=(0,l.Fl)((()=>{const e=u.value;if(e){let t=!1;const a=(r.value||[])[0];if(a&&a.items){const n=a.items;for(const a in n){const i=n[a];if(t)return i;i.id===e&&(t=!0)}}}})),m=(0,l.Fl)((()=>void 0!==p.value)),v=(e,t)=>{n.push({path:e+t})};return{haveCorpusId:s,havePrev:c,prev:d,haveNext:m,next:p,goTo:v}}};var r=a(4260),u=a(4607),d=a(7518),c=a.n(d);const p=(0,r.Z)(s,[["render",i]]),m=p;c()(s,"components",{QBtn:u.Z})},6816:(e,t,a)=>{a.r(t),a.d(t,{default:()=>X});a(7280);var n=a(3673),i=a(2323);const l={class:"row justify-center"},o={class:"row"},s={class:"col-7"},r={class:"row full-width q-py-sm"},u={class:"row full-width q-pb-sm"},d={class:"fit text-h5",filled:""},c=["onMouseover"],p={class:"row"},m=(0,n._)("div",{class:"col-1"},null,-1),v=["onClick"],g=["innerHTML"],b={class:"col-auto text-body1"},f={class:"col-5"},w={class:"col-3 text-body1"},y=["onClick"],h={key:0},q={key:1},k={class:"col text-body1"},I=["onClick"],_={key:0};function Z(e,t,a,Z,F,W){const P=(0,n.up)("q-btn"),Q=(0,n.up)("q-space"),x=(0,n.up)("Pagination"),z=(0,n.up)("q-btn-toggle"),D=(0,n.up)("q-separator"),C=(0,n.up)("q-badge"),T=(0,n.up)("q-tab"),$=(0,n.up)("q-tabs"),V=(0,n.up)("q-scroll-area"),L=(0,n.up)("q-tab-panel"),j=(0,n.up)("q-tab-panels"),S=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(S,{class:"q-pa-md"},{default:(0,n.w5)((()=>[(0,n._)("div",l,[(0,n.Wm)(P,{flat:"",round:"",icon:"edit",color:Z.state.editable?"primary":"secondary",onClick:t[0]||(t[0]=e=>Z.state.editable=!Z.state.editable)},null,8,["color"]),(0,n.Wm)(Q),(0,n.Wm)(x,{corpusId:Z.state.corpusId,currentId:Z.state.lineId},null,8,["corpusId","currentId"]),(0,n.Wm)(Q),(0,n.Wm)(z,{modelValue:Z.state.language3,"onUpdate:modelValue":t[1]||(t[1]=e=>Z.state.language3=e),"no-caps":"",rounded:"",unelevated:"","toggle-color":"primary",color:"white","text-color":"primary",options:[{label:"rus",value:"rus"},{label:"eng",value:"eng"}],onInput:t[2]||(t[2]=t=>e.switchLang(t))},null,8,["modelValue"])]),(0,n._)("div",o,[(0,n._)("div",s,[(0,n._)("div",r,(0,i.zw)(e.$t("line"))+"# "+(0,i.zw)(Z.state.lineNumber),1),(0,n._)("div",u,[(0,n._)("div",d,(0,i.zw)(Z.state.original),1)]),(0,n.Wm)(D),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Z.translation.details||[],((e,a)=>((0,n.wg)(),(0,n.iD)("span",{key:a,onMouseover:t=>Z.state.over=e,onMouseleave:t[3]||(t[3]=e=>Z.state.over="")},[(0,n._)("div",p,[m,(0,n._)("div",{class:(0,i.C_)(["col-2 text-body1 cursor-pointer",{warning:W.checkForError(e)}]),onClick:t=>Z.state.position={data:e,pos:a,type:"root"}},[(0,n._)("span",{class:(0,i.C_)(["text-body1",{selected:(Z.state.position||{}).data===e}]),innerHTML:W.formatLemma(e)},null,10,g)],10,v),(0,n._)("div",b,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(W.label(e.data,e.label).split("\n"),((e,t)=>((0,n.wg)(),(0,n.iD)("div",{class:"text-body1",key:"s"+t},(0,i.zw)(e),1)))),128))])]),(0,n.Wm)(D)],40,c)))),128))]),(0,n._)("div",f,[(0,n.Wm)($,{modelValue:Z.state.tab,"onUpdate:modelValue":t[4]||(t[4]=e=>Z.state.tab=e),dense:"",class:"text-grey bg-grey-3","active-color":"primary","indicator-color":"primary",align:"justify"},{default:(0,n.w5)((()=>[(0,n.Wm)(T,{name:"visual",label:e.$t("vocablary")},{default:(0,n.w5)((()=>[(0,n.Wm)(C,{color:"red",floating:""},{default:(0,n.w5)((()=>[(0,n.Uk)((0,i.zw)(Z.visualVariants.length),1)])),_:1})])),_:1},8,["label"])])),_:1},8,["modelValue"]),(0,n.Wm)(j,{modelValue:Z.state.tab,"onUpdate:modelValue":t[5]||(t[5]=e=>Z.state.tab=e),animated:"",swipeable:"",vertical:"","transition-prev":"jump-right","transition-next":"jump-left"},{default:(0,n.w5)((()=>[(0,n.Wm)(L,{name:"visual"},{default:(0,n.w5)((()=>[(0,n.Wm)(V,{style:{height:"500px","max-width":"100%"}},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Z.visualVariants,((t,a)=>((0,n.wg)(),(0,n.iD)("div",{class:"row",key:a},[(0,n._)("div",w,[(0,n.Wm)(D),(0,n.Uk)(" "+(0,i.zw)(t.lemma)+" "+(0,i.zw)(t.pos)+" ",1),(0,n._)("div",null,[(0,n._)("a",{class:"cursor-pointer",onClick:a=>e.openSearch(t.visual)},(0,i.zw)(t.visual),9,y),(0,n.Uk)(" "+(0,i.zw)(t.normaliazed),1)]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.dates||[],((e,t)=>((0,n.wg)(),(0,n.iD)("small",{class:"row",key:t},["UrIII"===e.k||"OB"===e.k?((0,n.wg)(),(0,n.iD)("b",h,(0,i.zw)(e.k)+" "+(0,i.zw)(e.v),1)):((0,n.wg)(),(0,n.iD)("span",q,(0,i.zw)(e.k)+" "+(0,i.zw)(e.v),1))])))),128))]),(0,n._)("div",k,[(0,n.Wm)(D),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.trans,((a,l)=>((0,n.wg)(),(0,n.iD)("div",{class:"row cursor-pointer",key:l,onClick:n=>e.selectTranslation(t,a)},[(0,n.Uk)((0,i.zw)(W.label(a.labels))+" ",1),a.count?((0,n.wg)(),(0,n.iD)("span",_," Â  "+(0,i.zw)(a.count)+" / "+(0,i.zw)(e.pcToString(a.pc))+"%",1)):(0,n.kq)("",!0)],8,I)))),128))])])))),128))])),_:1})])),_:1})])),_:1},8,["modelValue"])])])])),_:1})}var F=a(1959),W=a(2106),P=a(2610);const Q={name:"PageHebrewLine",components:{Pagination:W.Z},props:{id:{type:String,required:!0}},watch:{id(e,t){this.state.lineId=e,this.loadData()}},setup(e,t){const{Atom:a,Translation:i,Hebrew:l}=t.root.$FeathersVuex.api,o=(0,F.qj)({editable:!0,language2:"ru",language3:"rus",tab:"visual",corpusId:"",lineId:e.id,split:[],position:{data:{},pos:-1},lineNumber:"",original:""}),s=()=>{const e=o.lineId;e&&a.find({query:{class:"line",id:e,$sort:{createdAt:1},$limit:25}}).then((e=>{const t=((e||{}).data||[])[0]||{};o.corpusId=t.corpusId||"",o.lineNumber=t.number||"?",o.original=t.original||""}))};s();const{items:r}=(0,P.s)({model:i,params:(0,F.Fl)((()=>({query:{version:"draft",lineId:o.lineId,language:"hebrew"}}))),queryWhen:(0,F.Fl)((()=>o.lineId)),onEmpty:()=>{if(o.lineId){const e=new i({version:"draft",lineId:o.lineId,language:"hebrew",update:"reset"});e.create()}}}),u=(0,F.Fl)((()=>{const e=r.value[0];return console.log("translation",e),e||{}}));(0,n.YP)(u,((e,t)=>{o.translation=e||{}}));const d=(0,F.Fl)((()=>{const e=o.position||{};return console.log("p",e),"root"===e.type?((e.data||{}).cuneiform||{}).lemma:""})),{items:c}=(0,P.s)({model:l,params:(0,F.Fl)((()=>({query:{visual:d.value,$limit:50},paginate:!1}))),queryWhen:d}),p=(0,F.Fl)((()=>(console.log("visuals",c),[])));return{state:o,translation:u,visualVariants:p}},methods:{checkForError(e){return!1},label(e,t){if(t)return t;const a=((((e||{}).strong||{}).trans||[])[0]||{}).labels;return a&&(a[this.state.language3]||a.label)||""},formatLemma(e){return e.word}}};var x=a(4260),z=a(4379),D=a(4607),C=a(2025),T=a(8761),$=a(1289),V=a(7163),L=a(4554),j=a(5869),S=a(9721),B=a(6335),H=a(7011),M=a(3414),O=a(2035),U=a(7991),A=a(7704),Y=a(7547),E=a(3269),K=a(5906),N=a(6602),R=a(7518),G=a.n(R);const J=(0,x.Z)(Q,[["render",Z]]),X=J;G()(Q,"components",{QPage:z.Z,QBtn:D.Z,QSpace:C.Z,QBtnToggle:T.Z,QPopupEdit:$.Z,QInput:V.Z,QIcon:L.Z,QSeparator:j.Z,QBadge:S.Z,QMenu:B.Z,QList:H.Z,QItem:M.Z,QItemSection:O.Z,QRadio:U.Z,QScrollArea:A.Z,QTabs:Y.Z,QTab:E.Z,QTabPanels:K.Z,QTabPanel:N.Z})}}]);